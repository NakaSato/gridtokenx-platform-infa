<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="843px" preserveAspectRatio="none" style="width:807px;height:843px;background:#FFFFFF;" version="1.1" viewBox="0 0 807 843" width="807px" zoomAndPan="magnify"><title>GridTokenX Data Collection Flow</title><defs/><g><g class="title" data-source-line="5"><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="404.2715" x="196.8643" y="37.1182">GridTokenX Data Collection Flow</text></g><!--cluster Simulation Layer--><g class="cluster" data-qualified-name="Simulation Layer" data-source-line="7" id="ent0002"><path d="M362.5,58.7373 L496.3291,58.7373 A3.75,3.75 0 0 1 498.8291,61.2373 L505.8291,81.752 L744.5,81.752 A2.5,2.5 0 0 1 747,84.252 L747,149.8373 A2.5,2.5 0 0 1 744.5,152.3373 L362.5,152.3373 A2.5,2.5 0 0 1 360,149.8373 L360,61.2373 A2.5,2.5 0 0 1 362.5,58.7373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="360" x2="505.8291" y1="81.752" y2="81.752"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="132.8291" x="364" y="74.8125">Simulation Layer</text></g><!--cluster Ingestion Layer--><g class="cluster" data-qualified-name="Ingestion Layer" data-source-line="15" id="ent0007"><path d="M350.5,176.3373 L475.6816,176.3373 A3.75,3.75 0 0 1 478.1816,178.8373 L485.1816,199.352 L724.5,199.352 A2.5,2.5 0 0 1 727,201.852 L727,267.4273 A2.5,2.5 0 0 1 724.5,269.9273 L350.5,269.9273 A2.5,2.5 0 0 1 348,267.4273 L348,178.8373 A2.5,2.5 0 0 1 350.5,176.3373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="348" x2="485.1816" y1="199.352" y2="199.352"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="124.1816" x="352" y="192.4125">Ingestion Layer</text></g><!--cluster Processing Layer--><g class="cluster" data-qualified-name="Processing Layer" data-source-line="23" id="ent0012"><path d="M351.5,293.9273 L486.4502,293.9273 A3.75,3.75 0 0 1 488.9502,296.4273 L495.9502,316.942 L797.5,316.942 A2.5,2.5 0 0 1 800,319.442 L800,600.6573 A2.5,2.5 0 0 1 797.5,603.1573 L351.5,603.1573 A2.5,2.5 0 0 1 349,600.6573 L349,296.4273 A2.5,2.5 0 0 1 351.5,293.9273" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="349" x2="495.9502" y1="316.942" y2="316.942"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133.9502" x="353" y="310.0025">Processing Layer</text></g><!--cluster Storage Layer--><g class="cluster" data-qualified-name="Storage Layer" data-source-line="43" id="ent0025"><path d="M13.5,627.1573 L124.2578,627.1573 A3.75,3.75 0 0 1 126.7578,629.6573 L133.7578,650.172 L658.5,650.172 A2.5,2.5 0 0 1 661,652.672 L661,718.2573 A2.5,2.5 0 0 1 658.5,720.7573 L13.5,720.7573 A2.5,2.5 0 0 1 11,718.2573 L11,629.6573 A2.5,2.5 0 0 1 13.5,627.1573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="11" x2="133.7578" y1="650.172" y2="650.172"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="109.7578" x="15" y="643.2325">Storage Layer</text></g><!--entity SIM--><g class="entity" data-qualified-name="Simulation Layer.SIM" data-source-line="8" id="ent0003"><rect fill="#FFFFE0" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="88.127" x="375.94" y="97.0273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="68.127" x="385.94" y="121.1025">Simulator</text></g><g class="entity" data-qualified-name="Simulation Layer.GMN4" data-source-line="10" id="ent0005"><path d="M499.1,94.7373 L499.1,111.9573 L464.25,115.9573 L499.1,119.9573 L499.1,136.3359 A0,0 0 0 0 499.1,136.3359 L730.893,136.3359 A0,0 0 0 0 730.893,136.3359 L730.893,104.7373 L720.893,94.7373 L499.1,94.7373 A0,0 0 0 0 499.1,94.7373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M720.893,94.7373 L720.893,104.7373 L730.893,104.7373 L720.893,94.7373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="192.9434" x="505.1" y="112.8071">Solves grid physics equations</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="210.793" x="505.1" y="128.6064">Pandapower + Newton-Raphson</text></g><!--entity KAFKA--><g class="entity" data-qualified-name="Ingestion Layer.KAFKA" data-source-line="16" id="ent0008"><rect fill="#ADD8E6" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="111.3145" x="364.34" y="214.6273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="91.3145" x="374.34" y="238.7025">Kafka Broker</text></g><g class="entity" data-qualified-name="Ingestion Layer.GMN9" data-source-line="18" id="ent0010"><path d="M510.68,212.3373 L510.68,228.9573 L476.02,232.9573 L510.68,236.9573 L510.68,253.9359 A0,0 0 0 0 510.68,253.9359 L711.325,253.9359 A0,0 0 0 0 711.325,253.9359 L711.325,222.3373 L701.325,212.3373 L510.68,212.3373 A0,0 0 0 0 510.68,212.3373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M701.325,212.3373 L701.325,222.3373 L711.325,222.3373 L701.325,212.3373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="145.3867" x="516.68" y="230.4071">Topic: meter-readings</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179.645" x="516.68" y="246.2064">Partitions: 8, Replication: 3</text></g><!--entity CONSUMER--><g class="entity" data-qualified-name="Processing Layer.CONSUMER" data-source-line="24" id="ent0013"><rect fill="#90EE90" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="110.0977" x="364.95" y="329.9273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90.0977" x="374.95" y="354.0025">API Gateway</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="71.2168" x="374.95" y="371.0171">Consumer</text></g><g class="entity" data-qualified-name="Processing Layer.GMN14" data-source-line="26" id="ent0015"><path d="M509.94,336.1473 L509.94,352.9573 L475.43,356.9573 L509.94,360.9573 L509.94,377.7459 A0,0 0 0 0 509.94,377.7459 L728.0538,377.7459 A0,0 0 0 0 728.0538,377.7459 L728.0538,346.1473 L718.0538,336.1473 L509.94,336.1473 A0,0 0 0 0 509.94,336.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M718.0538,336.1473 L718.0538,346.1473 L728.0538,346.1473 L718.0538,336.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197.1138" x="515.94" y="354.2171">Rust Consumer (consumer.rs)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.915" x="515.94" y="370.0164">Validates schema</text></g><!--entity REDIS_Q--><g class="entity" data-qualified-name="Processing Layer.REDIS_Q" data-source-line="30" id="ent0017"><rect fill="#F08080" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="108.2725" x="364.86" y="446.2573"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.2725" x="374.86" y="470.3325">Redis Queue</text></g><g class="entity" data-qualified-name="Processing Layer.GMN18" data-source-line="32" id="ent0019"><path d="M508.47,443.9573 L508.47,460.9573 L473.48,464.9573 L508.47,468.9573 L508.47,485.5559 A0,0 0 0 0 508.47,485.5559 L711.5208,485.5559 A0,0 0 0 0 711.5208,485.5559 L711.5208,453.9573 L701.5208,443.9573 L508.47,443.9573 A0,0 0 0 0 508.47,443.9573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M701.5208,443.9573 L701.5208,453.9573 L711.5208,453.9573 L701.5208,443.9573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="182.0508" x="514.47" y="462.0271">List: queue:meter_readings</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.5625" x="514.47" y="477.8264">Depth monitoring</text></g><!--entity WORKER--><g class="entity" data-qualified-name="Processing Layer.WORKER" data-source-line="36" id="ent0021"><rect fill="#90EE90" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="105.1143" x="365.44" y="547.8473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.1143" x="375.44" y="571.9225">Worker Pool</text></g><g class="entity" data-qualified-name="Processing Layer.GMN22" data-source-line="38" id="ent0023"><path d="M506.01,545.5573 L506.01,561.9573 L470.93,565.9573 L506.01,569.9573 L506.01,587.1559 A0,0 0 0 0 506.01,587.1559 L783.9885,587.1559 A0,0 0 0 0 783.9885,587.1559 L783.9885,555.5573 L773.9885,545.5573 L506.01,545.5573 A0,0 0 0 0 506.01,545.5573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M773.9885,545.5573 L773.9885,555.5573 L783.9885,555.5573 L773.9885,545.5573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="240.4492" x="512.01" y="563.6271">4 Tokio tasks (reading_processor.rs)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="256.9785" x="512.01" y="579.4264">Validation &#8594; Enrichment &#8594; Persistence</text></g><!--entity HOT--><g class="entity" data-qualified-name="Storage Layer.HOT" data-source-line="44" id="ent0026"><rect fill="#FFC0CB" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="105.5313" x="27.23" y="665.4473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.5313" x="37.23" y="689.5225">Redis Cache</text></g><g class="entity" data-qualified-name="Storage Layer.GMN27" data-source-line="46" id="ent0028"><path d="M168.08,663.1573 L168.08,679.9573 L132.86,683.9573 L168.08,687.9573 L168.08,704.7559 A0,0 0 0 0 168.08,704.7559 L331.915,704.7559 A0,0 0 0 0 331.915,704.7559 L331.915,673.1573 L321.915,663.1573 L168.08,663.1573 A0,0 0 0 0 168.08,663.1573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M321.915,663.1573 L321.915,673.1573 L331.915,673.1573 L321.915,663.1573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="84.3857" x="174.08" y="681.2271">Hot: 60s TTL</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.835" x="174.08" y="697.0264">Real-time dashboards</text></g><!--entity WARM--><g class="entity" data-qualified-name="Storage Layer.WARM" data-source-line="50" id="ent0030"><rect fill="#ADD8E6" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="101.1699" x="367.42" y="665.4473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="81.1699" x="377.42" y="689.5225">PostgreSQL</text></g><g class="entity" data-qualified-name="Storage Layer.GMN31" data-source-line="52" id="ent0032"><path d="M503.38,663.1573 L503.38,679.9573 L469.08,683.9573 L503.38,687.9573 L503.38,704.7559 A0,0 0 0 0 503.38,704.7559 L644.611,704.7559 A0,0 0 0 0 644.611,704.7559 L644.611,673.1573 L634.611,663.1573 L503.38,663.1573 A0,0 0 0 0 503.38,663.1573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M634.611,663.1573 L634.611,673.1573 L644.611,673.1573 L634.611,663.1573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.231" x="509.38" y="681.2271">Warm: Permanent</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.457" x="509.38" y="697.0264">Billing &amp; History</text></g><!--entity COLD--><g class="entity" data-qualified-name="COLD" data-source-line="63" id="ent0040"><ellipse cx="707" cy="683.9573" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="39.375" x="687.3125" y="715.0325">COLD</text></g><!--entity ARCHIVE--><g class="entity" data-qualified-name="ARCHIVE" data-source-line="64" id="ent0042"><ellipse cx="418" cy="803.9573" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63.916" x="386.042" y="835.0325">ARCHIVE</text></g><!--link SIM to KAFKA--><g class="link" data-entity-1="ent0003" data-entity-2="ent0008" data-link-type="dependency" data-source-line="57" id="lnk34"><path d="M420,134.4273 C420,156.3773 420,186.3573 420,208.2873" fill="none" id="SIM-to-KAFKA" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="420,214.2873,424,205.2873,420,209.2873,416,205.2873,420,214.2873" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="75.6514" x="344" y="171.4271">Emits JSON</text></g><!--link KAFKA to CONSUMER--><g class="link" data-entity-1="ent0008" data-entity-2="ent0013" data-link-type="dependency" data-source-line="58" id="lnk35"><path d="M420,251.9373 C420,272.6373 420,300.1073 420,323.6773" fill="none" id="KAFKA-to-CONSUMER" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="420,329.6773,424,320.6773,420,324.6773,416,320.6773,420,329.6773" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.9517" x="287" y="287.8771">Consumes (rdkafka)</text></g><!--link CONSUMER to REDIS_Q--><g class="link" data-entity-1="ent0013" data-entity-2="ent0017" data-link-type="dependency" data-source-line="59" id="lnk36"><path d="M419.04,384.4273 C419.04,403.6473 419.04,422.8173 419.04,439.8173" fill="none" id="CONSUMER-to-REDIS_Q" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="419.04,445.8173,423.04,436.8173,419.04,440.8173,415.04,436.8173,419.04,445.8173" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="45.0493" x="373.04" y="412.1971">RPUSH</text></g><!--link REDIS_Q to WORKER--><g class="link" data-entity-1="ent0017" data-entity-2="ent0021" data-link-type="dependency" data-source-line="60" id="lnk37"><path d="M418,483.3973 C418,501.6073 418,523.2073 418,541.4973" fill="none" id="REDIS_Q-to-WORKER" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="418,547.4973,422,538.4973,418,542.4973,414,538.4973,418,547.4973" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130.165" x="287" y="512.5171">BRPOP (1s timeout)</text></g><!--link WORKER to HOT--><g class="link" data-entity-1="ent0021" data-entity-2="ent0026" data-link-type="dependency" data-source-line="61" id="lnk38"><path d="M365.19,565.9573 C270.12,565.9573 80,565.9573 80,565.9573 C80,565.9573 80,625.6473 80,658.9973" fill="none" id="WORKER-to-HOT" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="80,664.9973,84,655.9973,80,659.9973,76,655.9973,80,664.9973" style="stroke:#000000;stroke-width:1;"/></g><!--link WORKER to WARM--><g class="link" data-entity-1="ent0021" data-entity-2="ent0030" data-link-type="dependency" data-source-line="62" id="lnk39"><path d="M401.14,585.2573 C401.14,607.1973 401.14,637.1873 401.14,659.1073" fill="none" id="WORKER-to-WARM" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="401.14,665.1073,405.14,656.1073,401.14,660.1073,397.14,656.1073,401.14,665.1073" style="stroke:#000000;stroke-width:1;"/></g><!--link WORKER to COLD--><g class="link" data-entity-1="ent0021" data-entity-2="ent0040" data-link-type="dependency" data-source-line="63" id="lnk41"><path d="M434.86,585.0973 C434.86,612.1573 434.86,658.9573 434.86,658.9573 C434.86,658.9573 696.76,658.9573 700.95,658.9573" fill="none" id="WORKER-to-COLD" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="706.95,658.9573,697.95,654.9573,701.95,658.9573,697.95,662.9573,706.95,658.9573" style="stroke:#000000;stroke-width:1;"/></g><!--link WARM to ARCHIVE--><g class="link" data-entity-1="ent0030" data-entity-2="ent0042" data-link-type="dependency" data-source-line="64" id="lnk43"><path d="M418,702.7073 C418,728.9473 418,769.5673 418,789.0373" fill="none" id="WARM-to-ARCHIVE" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#000000" points="418,795.0373,422,786.0373,418,790.0373,414,786.0373,418,795.0373" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.1719" x="302" y="745.9371">Monthly snapshot</text></g><?plantuml-src XPJTRjCm5CVlynI7JKARe1C8X50k9lLhQ-bNbdGR2D1aahF6YkEJsGvLXRZb0NX4dWGxTKStMkXLxFFlyU_ypx6Vc1nBX4emBWDTS5annKf8gQn8eZI9MGa4XQbXSY5mIoAuHBEg44YPd8B0S6ELvufdSofGleSUCmow98JzCoS9PuAMGL2nj60BX8E4bxLWJMJCLgWEu5i0zlVH1qXz1gOX6KxWSCmNkVc0mcLm6ad6GhbDe5idQNO14X9VKSF2Ga2LhpHFDU1TtPoYlIPYCcCLBL71CvZYqf1inQpADSb6WJ9hyWVVjs27Se5w1-k8tHOCEifMlCOTjSz6RG_S4JNkm6qa7cPE5Kz3AD6WQYba6PUBFw3AUkh8GtZx76Ai14-RKa9ujHyrKfIYrZRH8zPsD8HpPd39LfzarwQjIm_TdKsJoqa_zjpd2b7k0D_8F5zSQmERF72K-gyJfO-zuee9djaJDUZKZXbx2EqMQx8OCwxXeiOQ6vwutnicDnSUfqkAYHquNkNF6dDjGhXpESB6pfj7TlQmCZcK9BaTBRk_3-QQb6qcH4IYWRcUnQF_MhCM-PDUsxOMdC0mNMWuyXmtrRenjCCXDrY_Vlo4lbGypKjxxvfbX4hRib2ckB_VYIt7VJnizjhIBhE-DrKCPdCuZBWiTi3RcCSPaFNmpGiDy_buqsLaecMuVICoflCln5IczraNaJOBXSd5UErSEvxy-oeuXJ_dcgaoT1MNpBqxVhV3XN2J_1G6rWXIgxzySEz3gtNgBru8_P8R3U-IsJHORxdW_O27cu5rVSaATtkFW_keasvcBuGukam6mMRjOduKGkZ4qIo2evSQd3DKc-F0nvpC-RcrR8hSMdTdurxGU7DoSWhjk3iONlLjqWb9auiLQCagdPC9VWC0?></g></svg>