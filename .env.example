# =============================================================================
# GridTokenX Platform - Root Environment Configuration
# =============================================================================
# This file contains the environment variables used across all services
# Copy this file to .env and update the values for your environment
# DO NOT commit .env files with sensitive data to version control
# =============================================================================

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================
ENVIRONMENT=development
NODE_ENV=development
TZ=UTC

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================
POSTGRES_DB=gridtokenx
POSTGRES_USER=gridtokenx_user
POSTGRES_PASSWORD=gridtokenx_password
DATABASE_URL=postgresql://gridtokenx_user:gridtokenx_password@localhost:5432/gridtokenx
MAX_CONNECTIONS=50
MIN_CONNECTIONS=5

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_PORT=6379
REDIS_POOL_SIZE=20
REDIS_MAX_CONNECTIONS=20

# =============================================================================
# INFLUXDB CONFIGURATION
# =============================================================================
INFLUXDB_URL=http://localhost:8086
INFLUXDB_TOKEN=your-influxdb-token
INFLUXDB_ORG=gridtokenx
INFLUXDB_BUCKET=energy_readings

# =============================================================================
# SOLANA BLOCKCHAIN CONFIGURATION
# =============================================================================
SOLANA_RPC_URL=http://localhost:8899
SOLANA_WS_URL=ws://localhost:8900
SOLANA_CLUSTER=localnet
SOLANA_VERSION=1.18.22
SOLANA_RPC_PORT=8899
SOLANA_WS_PORT=8900
SOLANA_FAUCET_PORT=9900

# -----------------------------------------------------------------------------
# Program IDs (from Anchor.toml - localnet)
# -----------------------------------------------------------------------------
REGISTRY_PROGRAM_ID=9XS8uUEVErcA8LABrJQAdohWMXTToBwhFN7Rvur6dC5
ENERGY_TOKEN_PROGRAM_ID=54SAVMgGhjssp3iQ7zBK8kgUnEtqHJTNg3QRfzzDitHB
TRADING_PROGRAM_ID=2pZ8gqotjvKMAu96XzpGZ7QFcemZzj21ybtVTbaDP1zG
ORACLE_PROGRAM_ID=F7mEgt7zaAaKHfTNmCLeZCUutdKyZ2cxYg41ggjstBi6
GOVERNANCE_PROGRAM_ID=GZP5QP6PMD2D8nNsLkhA39Lfr4er12JLMhQZJnhxyT5h

# Token Configuration
ENERGY_TOKEN_MINT=9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM

# =============================================================================
# API GATEWAY CONFIGURATION
# =============================================================================
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
APIGATEWAY_PORT=8080
RUST_LOG=info
LOG_LEVEL=info
LOG_FORMAT=json
REQUEST_TIMEOUT=30

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
JWT_SECRET=dev-jwt-secret-key-minimum-32-characters-long-for-development-2025
JWT_EXPIRATION=86400
API_KEY_SECRET=test-api-key-secret-for-development-and-testing
ENGINEERING_API_KEY=engineering-department-api-key-2025
HMAC_SECRET=hmac-signature-secret-change-in-production

# Password Requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true

# Security Settings
SECURE_COOKIES=false
SESSION_TIMEOUT=3600
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=900

# =============================================================================
# EMAIL CONFIGURATION (Mailpit)
# =============================================================================
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=noreply@gridtokenx.com
EMAIL_FROM_NAME=GridTokenX
EMAIL_FROM_ADDRESS=noreply@gridtokenx.com
EMAIL_VERIFICATION_ENABLED=true
EMAIL_VERIFICATION_REQUIRED=false
EMAIL_VERIFICATION_EXPIRY_HOURS=24
EMAIL_VERIFICATION_BASE_URL=http://localhost:3000
EMAIL_AUTO_LOGIN_AFTER_VERIFICATION=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_EMAIL_NOTIFICATIONS=true

# Mailpit Configuration
MAILPIT_SMTP_PORT=1025
MAILPIT_WEB_PORT=8025
MP_MAX_MESSAGES=5000
MP_DATABASE=/data/mailpit.db
MP_SMTP_AUTH_ACCEPT_ANY=1
MP_SMTP_AUTH_ALLOW_INSECURE=1

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:3002,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_EXPOSE_HEADERS=*
CORS_MAX_AGE=3600

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=60
RATE_LIMIT_AUTH_REQUESTS=10
RATE_LIMIT_AUTH_WINDOW=60
RATE_LIMIT_TRADING_REQUESTS=20
RATE_LIMIT_TRADING_WINDOW=60

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
AUDIT_LOG_ENABLED=true
ENABLE_METRICS=true
ENABLE_TRACING=true
PROMETHEUS_METRICS_ENABLED=true
METRICS_PORT=9090

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_WEBSOCKET=true
ENABLE_BLOCKCHAIN_INTEGRATION=true
ENABLE_PUSH_NOTIFICATIONS=false
ENABLE_SMS_NOTIFICATIONS=false
ENABLE_MARKET_DYNAMICS=true

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================
CACHE_TTL_DEFAULT=3600
CACHE_TTL_USER_SESSION=86400
CACHE_TTL_MARKET_DATA=300
CACHE_TTL_ANALYTICS=1800

# =============================================================================
# TOKENIZATION CONFIGURATION
# =============================================================================
TOKENIZATION_KWH_TO_TOKEN_RATIO=1.0
TOKENIZATION_DECIMALS=9
TOKENIZATION_MAX_READING_KWH=100.0
TOKENIZATION_READING_MAX_AGE_DAYS=7
TOKENIZATION_AUTO_MINT_ENABLED=true
TOKENIZATION_POLLING_INTERVAL_SECS=60
TOKENIZATION_BATCH_SIZE=50
TOKENIZATION_MAX_RETRY_ATTEMPTS=3
TOKENIZATION_INITIAL_RETRY_DELAY_SECS=300
TOKENIZATION_RETRY_BACKOFF_MULTIPLIER=2.0
TOKENIZATION_MAX_RETRY_DELAY_SECS=3600
TOKENIZATION_TRANSACTION_TIMEOUT_SECS=60
TOKENIZATION_MAX_TRANSACTIONS_PER_BATCH=20
TOKENIZATION_ENABLE_REAL_BLOCKCHAIN=false

# =============================================================================
# EVENT PROCESSOR CONFIGURATION
# =============================================================================
EVENT_PROCESSOR_ENABLED=true
EVENT_PROCESSOR_POLLING_INTERVAL_SECS=10
EVENT_PROCESSOR_BATCH_SIZE=100
EVENT_PROCESSOR_MAX_RETRIES=3

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================
WS_ENABLED=true
WS_HOST=localhost
WS_PORT=8765

# =============================================================================
# KEY PATHS (for blockchain operations)
# =============================================================================
AUTHORITY_WALLET_PATH=./dev-wallet.json
ENGINEERING_KEYPAIR_PATH=./validator-keys/engineering-keypair.json
ORACLE_KEYPAIR_PATH=./validator-keys/oracle-keypair.json
ENGINEERING_DEPT_KEYPAIR_PATH=./validator-keys/engineering-department-authority.json

# =============================================================================
# ORACLE & REC CONFIGURATION
# =============================================================================
PROCESSING_INTERVAL=900
ENGINEERING_AUTHORITY=true
REC_AUTHORITY_ONLY=true
REC_ISSUING_AUTHORITY=engineering-department
REC_CERTIFICATION_ENABLED=true
CARBON_OFFSET_RATE=0.7

# =============================================================================
# TEST MODE
# =============================================================================
TEST_MODE=true

# =============================================================================
# SERVICE PORTS
# =============================================================================
EXPLORER_PORT=3000
TRADING_PORT=3001
WEBSITE_PORT=3002
SMARTMETER_PORT=8000
ANCHOR_RPC_PORT=8899
ANCHOR_WS_PORT=8900

# =============================================================================
# SMART METER SIMULATOR CONFIGURATION
# =============================================================================
SIMULATION_INTERVAL=15
NUM_METERS=20
SIMULATION_SPEED_MULTIPLIER=1.0
RANDOM_SEED=42

# Solar Configuration
SOLAR_PANEL_EFFICIENCY_MIN=0.85
SOLAR_PANEL_EFFICIENCY_MAX=0.95
BASE_GENERATION_MIN=3.0
BASE_GENERATION_MAX=15.0

# Consumption Configuration
BASE_CONSUMPTION_MIN=1.5
BASE_CONSUMPTION_MAX=8.0
NOISE_FACTOR_MIN=0.05
NOISE_FACTOR_MAX=0.15

# P2P Trading Prices
MIN_SELL_PRICE=0.15
MAX_SELL_PRICE=0.35
MIN_BUY_PRICE=0.20
MAX_BUY_PRICE=0.40
GRID_FEED_IN_RATE=0.12
GRID_PURCHASE_RATE=0.28

# Weather Simulation
WEATHER_SUNNY_WEIGHT=0.4
WEATHER_PARTLY_CLOUDY_WEIGHT=0.3
WEATHER_CLOUDY_WEIGHT=0.15
WEATHER_OVERCAST_WEIGHT=0.1
WEATHER_RAINY_WEIGHT=0.05
WEATHER_CHANGE_FREQUENCY=5

# Battery Configuration
BATTERY_CAPACITY_MIN=10.0
BATTERY_CAPACITY_MAX=30.0
BATTERY_EFFICIENCY_MIN=0.90
BATTERY_EFFICIENCY_MAX=0.95

# Meter Type Distribution
SOLAR_PROSUMER_RATIO=0.40
GRID_CONSUMER_RATIO=0.35
HYBRID_PROSUMER_RATIO=0.20
BATTERY_STORAGE_RATIO=0.05

# =============================================================================
# NEXT.JS FRONTEND CONFIGURATION
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8080
NEXT_PUBLIC_SOLANA_RPC_URL=http://localhost:8899
NEXT_PUBLIC_SOLANA_NETWORK=localnet
NEXT_PUBLIC_PYTH_PRICE_SERVICE_URL=https://hermes.pyth.network
